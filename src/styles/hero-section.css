/* ===== SYSTÈME HORIZON-BASED + BANDEAU UI ===== */

:root {
  /* CORRECTION : Utiliser % au lieu de vh pour que le ratio reste fixe */
  --horizon-height: 33.33%; /* Horizon à 1/3 du CONTENEUR (pas vh!) */
  --sky-height: 66.67%;     /* 2/3 du conteneur = ciel */
  --ground-height: 33.33%;  /* 1/3 du conteneur = sol */
}

/* ===== FADE IN ===== */
/* ===== FADE IN - DÉSACTIVÉ ===== */

.hero-landscape {
  opacity: 1; /* Toujours visible maintenant */
  /* transition: opacity 2s ease-in; - Plus besoin */
}

/* .hero-landscape.fade-in-active { - Plus utilisé
  opacity: 1;
} */

/* ===== SECTION PAYSAGE ===== */

.hero-landscape {
  position: relative;
  width: 100%;
  height: 70vh;
  min-height: 500px;
  overflow: hidden;
}

.horizon-line {
  position: absolute;
  bottom: var(--horizon-height);
  left: 0;
  width: 100%;
  height: 2px;
  background: transparent;
  z-index: 0;
  pointer-events: none;
}

/* ===== COUCHE 1 : CIEL ===== */

.layer-sky {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 1;
  background: transparent; /* Laisser voir DynamicBackground */
}

/* Supprimer les backgrounds - on utilise DynamicBackground maintenant
.hero-landscape.dawn .layer-sky { ... }
.hero-landscape.day .layer-sky { ... }
.hero-landscape.dusk .layer-sky { ... }
.hero-landscape.night .layer-sky { ... }
*/

/* ===== COUCHE 2 : ÉTOILES ===== */

.layer-stars {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: var(--sky-height);
  z-index: 2;
  pointer-events: none;
}

.star {
  position: absolute;
  width: 2px;
  height: 2px;
  background: white;
  border-radius: 50%;
  animation: twinkle 3s ease-in-out infinite;
}

@keyframes twinkle {
  0%, 100% { opacity: 0.3; }
  50% { opacity: 1; }
}

/* ===== COUCHE 3 : SOLEIL/LUNE ===== */

.layer-celestial {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: var(--sky-height);
  z-index: 3;
  pointer-events: none;
}

.celestial {
  position: absolute;
  width: 70px;
  height: 70px;
  border-radius: 50%;
  top: 8%;
  right: 12%;
  transition: opacity 1s ease;
}

.celestial.sun {
  background: radial-gradient(circle, #ffe066, #ffb84d);
  box-shadow: 0 0 40px rgba(255, 224, 102, 0.8);
}

.celestial.moon {
  background: radial-gradient(circle, #f0f0f0, #d4d4d4);
  box-shadow: 0 0 30px rgba(240, 240, 240, 0.6);
}

.hero-landscape.dawn .sun { opacity: 0.8; }
.hero-landscape.day .sun { opacity: 1; }
.hero-landscape.dusk .sun { opacity: 0.5; }
.hero-landscape.night .sun { opacity: 0; }

.hero-landscape.dawn .moon { opacity: 0.2; }
.hero-landscape.day .moon { opacity: 0; }
.hero-landscape.dusk .moon { opacity: 0.5; }
.hero-landscape.night .moon { opacity: 1; }

/* ===== COUCHE 4 : NUAGES ===== */

.layer-clouds {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: var(--sky-height);
  z-index: 4;
  overflow: hidden;
  pointer-events: none;
}

.cloud {
  position: absolute;
  width: 120px;
  height: 40px;
  background: rgba(255, 255, 255, 0.5);
  border-radius: 50px;
  animation: cloud-scroll 50s linear infinite;
}

.cloud::before,
.cloud::after {
  content: '';
  position: absolute;
  background: rgba(255, 255, 255, 0.5);
  border-radius: 50%;
}

.cloud::before {
  width: 50px;
  height: 50px;
  top: -25px;
  left: 20px;
}

.cloud::after {
  width: 60px;
  height: 60px;
  top: -30px;
  right: 20px;
}

@keyframes cloud-scroll {
  from { transform: translateX(100vw); }
  to { transform: translateX(-200px); }
}

.hero-landscape.night .cloud,
.hero-landscape.night .cloud::before,
.hero-landscape.night .cloud::after {
  background: rgba(255, 255, 255, 0.08);
}

/* ===== COUCHE 5-6 : MONTAGNES ===== */

.layer-mountains-far {
  position: absolute;
  bottom: calc(var(--horizon-height) - 80px);
  left: 0;
  width: 200%;
  height: 200px;
  z-index: 5;
  display: flex;
  align-items: flex-end;
  gap: 100px;
  animation: mountains-scroll-slow 180s linear infinite;
}

.layer-mountains-near {
  position: absolute;
  bottom: calc(var(--horizon-height) - 40px);
  left: 0;
  width: 200%;
  height: 240px;
  z-index: 6;
  display: flex;
  align-items: flex-end;
  gap: 150px;
  animation: mountains-scroll-medium 120s linear infinite;
}

@keyframes mountains-scroll-slow {
  from { transform: translateX(0); }
  to { transform: translateX(-50%); }
}

@keyframes mountains-scroll-medium {
  from { transform: translateX(0); }
  to { transform: translateX(-50%); }
}

.mountain {
  width: 0;
  height: 0;
  border-style: solid;
  flex-shrink: 0;
}

.mountain.far-1 {
  border-width: 0 110px 140px 110px;
  border-color: transparent transparent rgba(60, 60, 80, 0.35) transparent;
}

.mountain.far-2 {
  border-width: 0 130px 170px 130px;
  border-color: transparent transparent rgba(50, 50, 70, 0.45) transparent;
}

.mountain.far-3 {
  border-width: 0 100px 130px 100px;
  border-color: transparent transparent rgba(55, 55, 75, 0.4) transparent;
}

.mountain.near-1 {
  border-width: 0 140px 190px 140px;
  border-color: transparent transparent rgba(40, 40, 60, 0.65) transparent;
}

.mountain.near-2 {
  border-width: 0 160px 220px 160px;
  border-color: transparent transparent rgba(35, 35, 55, 0.75) transparent;
}

/* ===== COUCHE 7 : ARBRES ===== */

.layer-trees {
  position: absolute;
  bottom: var(--horizon-height);
  left: 0;
  width: 100%;
  height: 150px;
  z-index: 7;
  /* Plus d'animation de scroll, les arbres apparaissent individuellement */
}

/* Animation pour les arbres qui traversent l'écran */
.tree {
  position: absolute;
  bottom: 0;
  left: 100%; /* Commence hors écran à droite */
  border-radius: 2px 2px 0 0;
  animation: tree-travel linear forwards;
}

@keyframes tree-travel {
  from {
    left: 100%;
    opacity: 0;
  }
  5% {
    opacity: 1;
  }
  95% {
    opacity: 1;
  }
  to {
    left: -100px;
    opacity: 0;
  }
}

/* ===== TYPE 1 : SAPIN (tronc marron, 50%) ===== */
.tree-pine {
  width: 18px;
  background: linear-gradient(to right, #5a4a3a, #4a3a2a, #3a2a1a);
}

/* Feuillage bas */
.tree-pine::before {
  content: '';
  position: absolute;
  top: -35px;
  left: 50%;
  transform: translateX(-50%);
  width: 0;
  height: 0;
  border-style: solid;
  border-width: 0 35px 50px 35px;
  border-color: transparent transparent #2a4a2a transparent;
}

/* Feuillage milieu */
.tree-pine::after {
  content: '';
  position: absolute;
  top: -55px;
  left: 50%;
  transform: translateX(-50%);
  width: 0;
  height: 0;
  border-style: solid;
  border-width: 0 30px 45px 30px;
  border-color: transparent transparent #3a5a3a transparent;
}

/* Feuillage haut (via élément enfant) */
.tree-pine-top {
  position: absolute;
  top: -75px;
  left: 50%;
  transform: translateX(-50%);
  width: 0;
  height: 0;
  border-style: solid;
  border-width: 0 25px 40px 25px;
  border-color: transparent transparent #4a6a4a transparent;
}

/* ===== TYPE 2 : CHÊNE DÉTAILLÉ (35%) ===== */
.tree-oak {
  width: 22px;
  background: linear-gradient(to right, #5a4a3a, #4a3a2a, #3a2a1a);
}

/* Feuillage principal (centre) */
.tree-oak::before {
  content: '';
  position: absolute;
  top: -45px;
  left: 50%;
  transform: translateX(-50%);
  width: 55px;
  height: 55px;
  background: radial-gradient(circle at 40% 40%, #5a7a4a, #4a6a3a, #3a5a2a);
  border-radius: 50%;
  box-shadow: 
    inset -5px -5px 10px rgba(0,0,0,0.3),
    inset 3px 3px 8px rgba(90,122,74,0.4);
}

/* Feuillage gauche */
.tree-oak::after {
  content: '';
  position: absolute;
  top: -35px;
  left: -12px;
  width: 40px;
  height: 40px;
  background: radial-gradient(circle at 50% 50%, #4a6a3a, #3a5a2a);
  border-radius: 50%;
  box-shadow: inset -3px -3px 8px rgba(0,0,0,0.25);
}

/* Feuillage droit (via élément enfant) */
.tree-oak-right {
  position: absolute;
  top: -30px;
  right: -8px;
  width: 38px;
  height: 38px;
  background: radial-gradient(circle at 50% 50%, #5a7a4a, #4a6a3a);
  border-radius: 50%;
  box-shadow: inset 3px -3px 8px rgba(0,0,0,0.2);
}

/* Feuillage haut (via élément enfant) */
.tree-oak-top {
  position: absolute;
  top: -58px;
  left: 50%;
  transform: translateX(-50%);
  width: 42px;
  height: 42px;
  background: radial-gradient(circle at 60% 50%, #6a8a5a, #5a7a4a);
  border-radius: 50%;
  box-shadow: inset 2px 2px 6px rgba(106,138,90,0.3);
}

/* ===== TYPE 3 : PIN PARASOL (15%) ===== */
.tree-umbrella {
  width: 16px;
  background: linear-gradient(to right, #5a4a3a, #4a3a2a, #2a1a0a);
}

/* Feuillage plat principal */
.tree-umbrella::before {
  content: '';
  position: absolute;
  top: -38px;
  left: 50%;
  transform: translateX(-50%);
  width: 80px;
  height: 48px;
  background: radial-gradient(ellipse at 50% 100%, #4a6a3a, #3a5a2a);
  border-radius: 50% 50% 18% 18%;
  box-shadow: inset 0 -8px 15px rgba(0,0,0,0.3);
}

/* Couche supérieure du feuillage */
.tree-umbrella::after {
  content: '';
  position: absolute;
  top: -45px;
  left: 50%;
  transform: translateX(-50%);
  width: 72px;
  height: 42px;
  background: radial-gradient(ellipse at 50% 100%, #5a7a4a, #4a6a3a);
  border-radius: 50% 50% 15% 15%;
  box-shadow: 
    inset 0 -5px 12px rgba(0,0,0,0.2),
    inset 8px 3px 10px rgba(90,122,74,0.3);
}


/* ===== COUCHE 8 : SOL ===== */

.layer-ground {
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  height: var(--ground-height);
  background: linear-gradient(to bottom, #4a6a4a, #3a5a3a);
  z-index: 8;
}

.grass {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 12px;
  background: repeating-linear-gradient(
    90deg,
    #5a7a5a 0px, #5a7a5a 4px,
    #4a6a4a 4px, #4a6a4a 8px
  );
}

/* ===== COUCHE 9 : PERSONNAGE (SPRITE COMPACT SANS CARRÉ GRIS) ===== */

.layer-character {
  position: absolute;
  bottom: var(--horizon-height);
  left: 50%;
  transform: translateX(-50%) scale(4); /* Agrandi x4 */
  transform-origin: bottom center;
  z-index: 9;
  /* CRITIQUE : Aucun background ET overflow hidden */
  background: transparent !important;
  overflow: visible; /* Permet aux pixels de dépasser */
}


/* ===== COUCHE 10 : UI OVERLAY ===== */

.layer-ui-top {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 10;
  pointer-events: none;
}

.layer-ui-top > * {
  pointer-events: auto;
}

.ui-top-left {
  position: absolute;
  top: 20px;
  left: 20px;
  font-family: 'Press Start 2P', cursive;
}

.greeting {
  font-size: 10px;
  color: var(--secondary);
  text-shadow: 2px 2px 0 rgba(0, 0, 0, 0.8);
  margin-bottom: 8px;
}

.day-counter {
  font-size: 14px;
  color: var(--primary);
  text-shadow: 3px 3px 0 rgba(0, 0, 0, 0.8);
}

/* Menu burger */
.ui-menu {
  position: absolute;
  top: 20px;
  right: 20px;
  z-index: 100;
}

.ui-menu-toggle {
  background: rgba(38, 43, 68, 0.9);
  border: 2px solid var(--pixel-border);
  color: var(--text);
  font-size: 20px;
  cursor: pointer;
  padding: 8px 12px;
  text-shadow: 2px 2px 0 rgba(0, 0, 0, 0.8);
  font-family: Arial, sans-serif;
  transition: all 0.2s;
}

.ui-menu-toggle:hover {
  background: var(--bg-light);
  border-color: var(--primary);
  color: var(--primary);
}

.ui-menu-dropdown {
  position: absolute;
  top: 100%;
  right: 0;
  margin-top: 8px;
  background: rgba(38, 43, 68, 0.98);
  border: 4px solid var(--pixel-border);
  min-width: 160px;
  box-shadow: 4px 4px 0 rgba(0, 0, 0, 0.5);
  animation: dropdown-appear 0.2s ease-out;
}

@keyframes dropdown-appear {
  from {
    opacity: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.menu-item {
  display: block;
  width: 100%;
  background: none;
  border: none;
  border-bottom: 2px solid var(--bg-dark);
  color: var(--text);
  font-family: 'VT323', monospace;
  font-size: 18px;
  padding: 12px 16px;
  text-align: left;
  cursor: pointer;
  transition: all 0.2s;
}

.menu-item:last-child {
  border-bottom: none;
}

.menu-item:hover {
  background: var(--bg-light);
  color: var(--primary);
}

.ui-scroll-hint {
  position: absolute;
  bottom: 15px;
  left: 50%;
  transform: translateX(-50%);
  text-align: center;
  animation: bounce-hint 2s ease-in-out infinite;
}

.scroll-arrow {
  font-size: 24px;
  color: var(--primary);
  text-shadow: 2px 2px 0 rgba(0, 0, 0, 0.8);
}

.scroll-text {
  font-family: 'Press Start 2P', cursive;
  font-size: 8px;
  color: var(--text-dim);
  text-shadow: 1px 1px 0 rgba(0, 0, 0, 0.8);
  margin-top: 4px;
}

@keyframes bounce-hint {
  0%, 100% { transform: translateX(-50%) translateY(0); }
  50% { transform: translateX(-50%) translateY(-10px); }
}

.ui-version {
  position: absolute;
  bottom: 8px;
  left: 8px;
  font-family: 'Press Start 2P', cursive;
  font-size: 7px;
  color: rgba(255, 255, 255, 0.3);
  text-shadow: 1px 1px 0 rgba(0, 0, 0, 0.5);
}

/* ===== BANDEAU INFO EN BAS ===== */

.hero-info-bar {
  background: rgba(26, 28, 44, 0.95);
  border-top: 4px solid var(--pixel-border);
  padding: 16px 20px;
}

.info-bar-content {
  max-width: 1200px;
  margin: 0 auto;
  display: flex;
  align-items: center;
  gap: 20px;
  flex-wrap: wrap;
}

.character-info-compact {
  font-family: 'Press Start 2P', cursive;
  display: flex;
  align-items: center;
  gap: 12px;
  flex-wrap: wrap;
}

.character-name-compact {
  font-size: 16px;
  color: var(--primary);
  text-shadow: 2px 2px 0 rgba(0, 0, 0, 0.8);
}

.character-class-compact {
  font-size: 12px;
  color: var(--text);
  text-shadow: 2px 2px 0 rgba(0, 0, 0, 0.8);
}

.character-level-compact {
  display: inline-block;
  background: var(--primary);
  color: var(--bg-dark);
  font-size: 10px;
  padding: 3px 7px;
}

.xp-bar-compact {
  flex: 1;
  min-width: 200px;
  max-width: 400px;
  height: 20px;
  background: rgba(0, 0, 0, 0.5);
  border: 3px solid var(--pixel-border);
  position: relative;
}

.xp-fill-compact {
  height: 100%;
  background: repeating-linear-gradient(
    90deg,
    var(--secondary) 0px, var(--secondary) 6px,
    #3aa8d8 6px, #3aa8d8 12px
  );
  transition: width 0.3s ease;
}

.xp-text-compact {
  position: absolute;
  right: 8px;
  top: 50%;
  transform: translateY(-50%);
  font-family: 'Press Start 2P', cursive;
  font-size: 8px;
  color: var(--text);
  text-shadow: 1px 1px 0 rgba(0, 0, 0, 0.8);
}

/* ===== RESPONSIVE ===== */

@media (max-width: 768px) {
  .hero-landscape {
    height: 60vh;
    min-height: 450px;
  }

  .layer-character {
    transform: translateX(-50%) scale(3);
  }

  .character-name-compact {
    font-size: 14px;
  }
}

@media (max-width: 500px) {
  .hero-landscape {
    height: 55vh;
    min-height: 400px;
  }

  .layer-character {
    transform: translateX(-50%) scale(2.5);
  }

  .greeting {
    font-size: 8px;
  }

  .day-counter {
    font-size: 12px;
  }

  .hero-info-bar {
    padding: 12px 16px;
  }

  .character-name-compact {
    font-size: 12px;
  }

  .xp-bar-compact {
    min-width: 100%;
  }
}
